# rx-template-importdata
Репозиторий с шаблоном разработки «Утилита импорта данных».

## Описание
Шаблон позволяет перенести исторические данные в DirectumRX. 
В качестве источника данных для переноса используются книги Excel с расширением XLSX.
Чтобы произвести миграцию документов и справочников в DirectumRX из заменяемой системы, достаточно заполнить специально сформированные шаблоны Excel и запустить утилиту из командной строки с необходимыми параметрами.

### На текущий момент реализована возможность импорта следующих типов документов:
1. Договоры;
2. Дополнительные соглашения;
3. Входящие письма;
4. Исходящие письма;
5. Приказы.

### Справочников:
1. Организации (Контрагенты);
2. Наши организации;
3. Подразделения;
4. Должности;
5. Сотрудники;
6. Персоны.

## Модификация

Для модификации утилиты требуется наличие на рабочем месте разработчика:
1. Visual Studio 2017 и выше.
2. Установленый пакет .net framework 4.6.2 и выше.

Модификация выполняется за счет наследования и доработки реализованных классов:
* Класс Entity - базовый абстрактный класс, от которого наследованы остальные классы.
* Классы справочников (Databooks):  BusinessUnit, Company, Department, Employee, Person - реализуют процесс импорта исторических данных в справочники системы Directum RX.
* Классы документов (EDocs): Contract, IncomingLetter, Order, OutgoingLetter, SupAgreement - реализуют процесс импорта документов с телами (или без тел) в систему Directum RX.
* Методы, которые прямо не относятся к классам сущностей реализуются в классе BusinessLogic.
* Механизмы работы с XLSX реализованы в классе ExcelProcessor. В качестве механизма работы с XLSX используется библиотека OpenXml.
* Общие механизмы работы с сущностями реализованы в классах EntityProcessor и EntityWrapper.

## Подготовка инсталлятора

Для сблоки инсталлятора используется утилита NSIS (https://github.com/kichik/nsis).
В папке решения https://github.com/DirectumCompany/rx-template-importdata/tree/master/Install находится готовый конфигурационный файл DirRxInstaller.nsi для генерации инсталлятора.

## Порядок установки и использования

Порядок установки и использования описан в документе https://github.com/DirectumCompany/rx-template-importdata/blob/master/doc/Instructions_for_loading_data_into_DirectumRX_rus.pdf
